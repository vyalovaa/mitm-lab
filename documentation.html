	<!DOCTYPE html>
	<html lang="ru">
		<head>
			<meta charset="utf-8">
			<meta http-equiv="X-UA-Compatible" content="IE=edge">
			<title>Методическое пособие / Лабораторная работа. Человек посередине</title>
			<meta name="description" content="SQL Injection Lab">
			<meta name="viewport" content="width=device-width, initial-scale=1">

			<link href="css/bootstrap.min.css" rel="stylesheet">

			<style>
				h4 {
					margin-top: 10px;
				}
				h3 {
					margin-top: 25px;
				}
				.nav-inner {
					margin-left: 10px;
				}
				.demo-slot {
					color: #EE0000;
				}
				.callout { 
					border-left: 5px solid #EEEEEE;
					margin: 20px 0px;
					padding: 15px 30px 15px 15px;
				}
				.callout-info { 
					background-color: #F0F7FD;
					border-color: #D0E3F0;
				}
				figure.img {
					margin: 0;
					text-align: center;
				}
				figure.img img {  <!--/* изображение уменьшается пропорционально экрану браузера */-->
					max-width: 100%;
					height: auto;
				}
				figure.img figcaption {  <!--/* стиль описания */-->
					padding: 0 1%;
					font: italic 90% Georgia,serif;
				}
			</style>

			<!--[if lt IE 9]>
				<script src="js/lib/respond.min.js"></script>
			<![endif]-->
		</head>
		<body>
			<!--[if lt IE 7]>
				<p class="browsehappy">You are using an <h4>outdated</h4> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
			<![endif]-->

			<div class="container">
				<div class="site-header">
					<h1 class="text-center">Учебный сайт "MitM"</h1>
				</div>
				<hr>
				<div class="page-header">
					<h1 class="text-center">Лабораторная работа <small>&laquo;Человек посередине&raquo;</small></h1>
				</div>

				<div class="row">
					<div class="col-md-3">
						<ul class="nav nav-pills nav-stacked">
							<li><a href=".">Главная</a></li>
							<li class="active">
								<a href="#">Методическое пособие</a>
								<ul class="nav nav-pills nav-stacked nav-inner">
									<li><a href="#varieties">Разновидности атаки типа «Человек посередине»</a></li>
									<li><a href="#vulnerability">Уязвимости атаки типа «Человек посередине»</a></li>
									<li><a href="#find">Обнаружение атаки типа «Человек посередине»</a></li>
									<li><a href="#defence">Способы защиты от атаки типа «Человек посередине»</a></li>
									<li><a href="#sandbox">Песочница</a></li>
									<!--<li><a href="#materials">Дополнительные материалы</a></li>-->
								</ul>
							</li>
							<li><a href="materials.html">Материалы</a></li>
							<li><a href="task.html">Ход выполнения работы</a></li>
							<li><a href="question.html">Контроль знаний</a></li>
							<li><a href="https://github.com/vyalovaa/mitm-lab" target="_blank">Исходный код</a></li>
						</ul>
					</div>

					<div class="col-md-9">
						<div class="well well-lg">
							<p>
								«Человек посередине» (англ. <i>Man in the middle</i>) — термин, обозначающий ситуацию, когда злоумышленник способен перехватывать, 
								перенаправлять и изменять по своей воле сообщения, которыми обмениваются пользователи, причём ни один из них не может догадаться о присутствии злоумышленника в канале.
							</p>
							<p>						
								«Человек посередине» - это метод компрометации канала связи, при котором злоумышленник, подключившись к каналу между контрагентами, 
								выполняет активное вмешательство в протокол передачи, навязывая ложную, искажая или удаляя информацию.
							</p>
							<p>	
								Атака типа «Человек посередине» обычно начинается с прослушивания канала связи и заканчивается попыткой злоумышленника извлечь выгоду из перехваченного сообщения, 
								подменить сообщение, перенаправить его на внешний ресурс.
							</p>
							<p>	
								Пример: 
								<br>
								Объект A передает объекту B некоторую информацию. Объект C обладает знаниями о структуре и свойствах протоколов, планирует перехватить эту информацию. 
								Чтобы совершить атаку объект С "представляется" объекту А - объектом В, а объекту В — объектом А. Таким образом, объект А отправляя информацию объекту В, 
								неосознанно посылает её объекту С. В свою очередь объект С, получив информацию и совершив с ней некоторые действия пересылает данные настоящему объекту В. 
								Объект В, ничего не подозревая, считает, что информация была получена напрямую от объекта А. Пример представлен на рисунке 1.
								<br>
								<!--<img src = "img/mitm.jpg">-->
								<figure class="img">
									<img alt="человек посередине" src="img/mitm.jpg" height="50%" width="50%">
									<figcaption>Рис.1 Пример атаки типа «Человек посередине»</figcaption>
								</figure>
								

							</p>
							
							<h3 id="varieties">Разновидности атаки типа «Человек посередине»</h3>
							<p>
							<h4>Session hijacking или HTTP session hijacking</h4> 
							
								Атака "угон" сеанса или "угон" HTTP-сеанса состоит из эксплуатации механизма управления веб-сессии, которая обычно управляется параметром, 
								который называется SESSION ID.
								Поскольку протокол HTTP использует множество различных TCP-соединений, веб-серверу необходим способ распознавать соединения 
								каждого пользователя. Наиболее полезный метод зависит от идентификатора, который веб-сервером отправляется 
								в браузер клиента после успешной аутентификации клиента. Этот идентификатор, как правило, состоит из строки переменной ширины 
								и ее можно использовать по-разному, как в URL, так и в заголовке HTTP-запроса – cookie, а также в других частях 
								заголовка запроса HTTP, или еще в теле HTTP-запроса. "Угон" сеанса представлен на рисунке 2.

								<figure class="img">
									<img alt="session hijacking" src="img/session_hijacking.jpg" height="45%" width="45%">
									<figcaption>Рис.2 "Угон" сеанса</figcaption>
								</figure>
								Атака "угон" сеанса компрометирует идентификатор путем его кражи или правильного его предсказания, 
								для получения несанкционированного доступа к веб-серверу [14]. SESSION ID является уникальным идентификатором HTTP-сессии [15]. 
								Более подробная схема "угона" HTTP-сеанса представлена на рисунке 3. 
								
								<figure class="img">
									<img alt="HTTP session hijacking" src="img/http_session_hijacking.jpg" height="50%" width="50%">
									<figcaption>Рис.3 "Подробная схема "угона" HTTP-сеанса</figcaption>
								</figure>
							</p>
							<p>
							<h4>ARP Cache Poisoning</h4> 
								ARP-spoofing (ARP-poisoning) — техника сетевой атаки, которая применяется в Ethernet, 
								но возможна и в других протоколах, использующих ARP. Она основана на использовании недостатков протокола ARP 
								и позволяет перехватить трафик между хостами, расположенными в пределах одного широковещательного домена. 
								Она относится к числу spoofing атак.
							</p>
							
							<p>
								Протокол ARP был разработан из-за необходимости обеспечения трансляции адресов между вторым и третьим уровнем модели OSI. 
								Второй уровень, канальный уровень, использует MAC-адреса с тем, чтобы аппаратные устройства могли взаимодействовать 
								напрямую друг с другом в небольших масштабах. Третий уровень, или сетевой уровень, использует IP-адреса (как правило) 
								для создания больших масштабных сетей, которые могут взаимодействовать друг с другом по всему миру. Канальный уровень 
								работает непосредственно с устройствами, соединенными вместе, в то время как сетевой уровень работает с устройствами, 
								которые подключены напрямую и косвенно. Каждый уровень имеет свою схему адресации, и они должны работать вместе, чтобы 
								сделать коммуникацию возможной. По этой причине был создан протокол ARP с RFC 826, 'Протокол разрешения адреса Ethernet 
								An Ethernet Address Resolution Protocol)'. Процесс ARP-взаимодействия представлен на рисунке 4.
								
								<figure class="img">
									<img alt="ARP Communication Proccess" src="img/arp_communications_proccess.png" height="50%" width="50%">
									<figcaption>Рис.4 Процесс ARP-взаимодействия</figcaption>
								</figure>
							</p>
							
							<p>	
								Суть работы ARP сконцентрирована вокруг двух пакетов, ARP-запрос и ARP-ответ. Целью запроса и ответа является обнаружение 
								физического адреса аппаратного оборудования, связанного с определенным IP-адресов, чтобы трафик мог дойти до пункта назначения 
								в сети. Пакет запроса направляется на каждое устройство в сетевом сегменте и говорит 'Привет, мой IP-адрес - XX.XX.XX.XX, 
								а MAC-адрес - XX:XX:XX:XX:XX:XX. Мне нужно отправить кое-что тому, у кого IP-адрес - XX.XX.XX.XX, но я не знаю их физический 
								адрес. Не мог бы тот, у кого такой IP-адрес, ответить со своего MAC-адреса?' Ответ придет с пакетом ответа ARP и говорит 
								следующее: 'Привет передающее устройство. Я тот, кого вы ищите с IP-адресом XX.XX.XX.XX. Мой MAC-адрес - XX:XX:XX:XX:XX:XX.' 
								Когда эта операция завершена, передающее устройство обновит свою таблицу ARP-кэша и устройства смогут взаимодействовать друг 
								с другом.
							</p>
							
							<p>
								Отравление ARP-кэша использует небезопасную природу протокола ARP. В отличие от таких протоколов, как DNS, которые можно 
								настроить на прием только защищенных динамических обновлений, устройства, использующие ARP, будут получать обновления в любое 
								время. Это означает, что любое устройство может отправить пакет ARP-ответа на другой узел и заставить этот узел обновить свой 
								ARP-кэш новым значением. Отправка ARP-ответа без генерирования каких-либо запросов называется отправкой самообращенных ARP. 
								Если имеются злоумышленные намерения, результатом удачно направленных самообращенных ARP-пакетов, используемых таким образом, 
								могут стать узлы, считающие, что они взаимодействуют с одним узлом, но в реальности они взаимодействуют с перехватывающим узлом 
								взломщика. Отравление ARP-кэша представлено на рисунке 5.
								
								<figure class="img">
									<img alt="ARP Cache Poisoning" src="img/arp_cache_poisoning.png" height="50%" width="50%">
									<figcaption>Рис.5 Процесс ARP-взаимодействия</figcaption>
								</figure>
							</p>
							
							<p>
								<h4>DNS-spoofing</h4> 
								Подмена DNS представляет собой прием, используемый для предоставления ложной DNS информации на компьютер, чтобы при попытке 
								просмотра, например, сайта www.bankofamerica.com по IP-адресу XX.XX.XX.XX, этот компьютер был направлен на поддельный www.bankofamerica.com 
								сайт, расположенный по IP-адресу YY.YY.YY.YY, который взломщик создал для того, чтобы украсть интерактивные банковские учетные 
								данные и информацию учетной записи у ничего не подозревающего пользователя. 
							</p>
							
							<p>	
								Протокол системы доменных имен (Domain Name System - DNS) некоторые считают одним из важнейших протоколов, используемых в интернете. 
								Такая точка зрения обоснована тем, что DNS обеспечивает целостность системы. В каркасе, когда вводится веб-адрес, например, 
								http://www.google.com в обозреватель, DNS-запрос посылается на DNS-сервер, чтобы определить, к какому IP-адресу принадлежит это имя. 
								Это происходит потому, что роутеры и устройства, связывающие интернет, не понимают адрес google.com, они лишь понимают такие 
								адреса, состоящие из цифр.
							</p>
							
							<p>
								Работа DNS-сервера заключается в хранении базы записей (под названием записи ресурсов) IP-адресов для сопоставления 
								с DNS-именами, передавая эти записи ресурсов клиентам, а также другим DNS-серверам. Архитектура DNS-серверов в 
								организациях и интернете может быть сложной. На самом деле, есть целые книги, посвященные архитектуре DNS. 
								Рассмотрим основу DNS взаимодействия, которая показана на рисунке 6.
								<figure class="img">
									<img alt="dns_query_response" src="img/dns_query_response.png" height="80%" width="80%">
									<figcaption>Рис.6 DNS-запрос и ответ</figcaption>
								</figure>
								DNS функционирует в формате запрос/ответ. Клиент, желающий преобразовать DNS-имя в IP-адрес, отправляет запрос 
								на DNS-сервер, а сервер отправляет запрошенную информацию в своем ответе. С точки зрения клиентов единственными 
								двумя пакетами являются эти запрос и ответ.
							</p>
							
							<p>
								Рассмотрим методику подмены DNS ID. Каждый DNS-запрос, направляемый по сети, содержит уникальный идентификационный номер, 
								задачей которого является идентификация запросов и ответов и их связывание. Это означает, что, если злоумышленный 
								компьютер сможет перехватить DNS-запрос, отправленный с целевого устройства, ему, лишь, придется создать ложный пакет, 
								который будет содержать этот идентификационный номер, чтобы пакет был принят целевым устройством.
								<br>
								Этот процесс выполняется в два шага. Сначала, нужно выполнить отравление ARP-кэша на целевом устройстве, 
								чтобы направить его трафик через атакующий компьютер, чтобы можно было перехватить DNS-запрос, а затем отправить 
								собственно поддельный пакет. Здесь нужно заставить пользователя целевого компьютера посетить вредоносный сайт, 
								а не тот сайт, к которому пользователь изначально хотел получить доступ. Эта атака показана на рисунке 7.
								<figure class="img">
									<img alt="dns_spoofing" src="img/dns_spoofing.png" height="80%" width="80%">
									<figcaption>Рис.7 Атака DNS-spoofing</figcaption>
								</figure>
							</p>
							
							<p>
							<h4>SSL Hijacking </h4>  
								Secure Socket Layers (SSL) или Transport Layer Security (TLS) в более современном применении представляют собой протоколы, 
								созданные для обеспечения безопасности сетевых подключений посредством шифрования. Этот протокол чаще всего связывают 
								с другими протоколами для обеспечения безопасного применения служб, которые предоставляет данный протокол. Сюда входит 
								SMTPS, IMAPS и чаще всего HTTPS. Конечной целью является создание защищенных каналов в незащищенной сети.
							</p>

							<p>	
								Сконцентрируемся на атаках SSL через HTTP, также известного как HTTPS, поскольку это самая распространенная модель реализации 
								протокола SSL. Самые популярные службы электронной почты и сетевые банковские приложения полагаются на HTTPS для обеспечения 
								шифрования канала между интернет обозревателем и этими службами. Если бы не эти технологии, то любой пользователь с 
								анализатором пакетов смог бы перехватить ваше имя пользователя, пароли и любую другую информацию, которая обычно передается в 
								скрытом виде.
							</p>	
							<p>	
								Процесс, используемый протоколом HTTPS для обеспечения безопасности данных, основан на распределении сертификатов между сервером, 
								клиентом и доверенной третьей стороной. Допустим, пользователь пытается подключиться к учетной записи на Gmail. Это включает несколько 
								четких шагов, которые в упрощенном виде показаны на рисунке 8.
								<figure class="img">
									<img alt="https_communications" src="img/https_communications.png" height="80%" width="80%">
									<figcaption>Рис.8 HTTPS взаимодействие</figcaption>
								</figure>
								Данный процесс, изображенный на рисунке 8, работает по следующему принципу:
								<ul>															
								<li>1.	Клиентский браузер подключается к http://mail.google.com на порт 80, используя HTTP.</li>
								<li>2.	Сервер перенаправляет клиентскую HTTPS версию этого сайта, используя HTTP code 302 перенаправление.</li>
								<li>3.	Клиент подключается к https://mail.google.com на порт 443.</li>
								<li>4.	Сервер предоставляет клиенту сертификат, содержащий его цифровую подпись. Этот сертификат используется для проверки идентификации сайта.</li>
								<li>5.	Клиент получает этот сертификат и сверяет его в своем списке доверенных центров сертификации.</li>
								<li>6.	Создается зашифрованное соединение.</li>
								</ul>
								Если процесс проверки сертификата прошел неуспешно, это означает, что веб-сайт не смог подтвердить свою идентификацию. 
								На этом этапе пользователю обычно выдается ошибка проверки сертификата, после чего пользователи могут продолжить работу 
								на свой страх и риск, так как это может быть настоящий сайт, а может быть и поддельный. 
							</p>
							<p>
								Этот процесс считался крайне надежным до недавнего времени, когда была проведена атака, позволившая успешно перехватить процесс такой коммуникации. 								
								Этот процесс не включает взлом самого SSL, он включает взлом «моста» между незашифрованным и зашифрованным взаимодействием.
								Moxie Marlinspike, широко известный сотрудник безопасности ИТ, высказал гипотезу о том, что в большинстве случаев SSL 
								практически нигде не встречается в чистом виде. То есть, в большинстве случаев SSL подключение создается через HTTPS, 
								поскольку кто-то был перенаправлен на HTTPS через код ответа HTTP 302 или нажав на ссылку, которая перенаправляет их на 
								HTTPS сайт, например, кнопка входа. Суть в том, что, если попытаться осуществить атаку на точку перехода от незащищенного 
								на защищенное соединение, в данном случае с HTTP на HTTPS, можно будет атаковать мост и можно выполнить атаку на SSL подключение 
								до того, как оно будет создано. Чтобы этого добиться, Moxie создал инструмент SSLstrip. Принцип его работы приведен на рисунке 9.
								
								<figure class="img">
									<img alt="https_hijacking_communications" src="img/https_hijacking_communications.png" height="80%" width="80%">
									<figcaption>Рис.9 Подмена HTTPS взаимодействия</figcaption>
								</figure>
								<ul>
								Процесс, показанный на рисунке 9, работает следующим образом:
								<li>1.	Трафик между клиентом и веб-сервером перехватывается.</li>
								<li>2.	Когда HTTPS URL адрес обнаруживается, инструмент sslstrip заменяет его HTTP ссылкой и сопоставляет все изменения. </li>
								<li>3.	Атакующая машина предоставляет сертификаты веб-серверу и олицетворяет клиента. </li>
								<li>4.	Трафик принимается с защищенного веб-сайта и предоставляется клиенту.</li>
								</ul>
							</p>
							<p>												
							<h4>WPAD MITM</h4> 							
								Web Proxy Auto-Discovery Protocol (WPAD) — это протокол автоматической настройки прокси, который используется 
								клиентами (браузером) для определения места (URL) расположения конфигурационного файла с использованием технологий 
								DHCP и/или DNS. При совершении запроса браузером вызывается функция FindProxyForURL из PAC-файла, куда передается 
								URL и хост. Ожидаемый ответ — список прокси, через которые будет осуществляться выход на этот адрес [22].
							</p>
							
							<p>
								Сущность его работы состоит в том, что если клиент использует DHCP для получения IP-адреса, то и за 
								URL с настройкой прокси он обращается к своему DHCP серверу. Если DHCP не настроен на выдачу 
								WPAD-конфигурации, если в сети не используется DHCP, то клиент попробует дать разрешение сетевому 
								имени вида wpad.localdomain, используя DNS. Если данного имени не найдено, то делается последняя 
								попытка поиска имени 'WPAD' через NetBios. В случае, если после последней попытки имя не найдено, 
								клиент пробует соединиться напрямую, но в том случае, если кто-то сказал, что имеет имя 'WPAD', 
								то клиент соединится по 80 порту на IP-адрес ответившего хоста и попытается загрузить файл wpad.dat, 
								в котором должны быть настройки прокси. Работа протокола WPAD представлена на рисунке 10.

								<figure class="img">
									<img alt="wpad" src="img/wpad.png" height="80%" width="80%">
									<figcaption>Рис.10 Работа протокола WPAD</figcaption>
								</figure>
								<br>
								Размещение конфигурационного PAC-файла можно определить с использованием Dynamic Host Configuration Protocol (DHCP), 
								Domain Name System (DNS) или Link-Local Multicast Name Resolution (LLMNR). Киберпреступники при желании могут 
								использовать уязвимость в WPAD, указав размещение специально сконфигурированного PAC-файла, который направит 
								запрос браузера через прокси-серверы, находящиеся под контролем злоумышленников. Этого можно добиться в открытой 
								беспроводной сети, скомпрометировав роутер или точку доступа, либо открыв для всех желающих доступ к собственной 
								точке доступа, сконфигурированной должным образом. Сценарий атаки с использованием DNS-сервера представлен на рисунке 11.
								
								<figure class="img">
									<img alt="wpad_mitm" src="img/wpad_mitm.png" height="80%" width="80%">
									<figcaption>Рис.11 Сценарий атаки с использованием DNS-сервера</figcaption>
								</figure>
							</p>
							
							<p>
							<h4>SSH MITM</h4> 
							 Злоумышленник перенаправляет трафик жертвы на свой собственный ssh сервер. 
							 Жертва не замечает этого, и она заканчивает обмен сеансовым ключом с злоумышленником. 
							 Одновременно, он также инициирует свою собственную связь с целевым сервером жертвы, получение 
							 отдельного ключа сеанса с сервером. Злоумышленник может войти под видом жертвы, потому что она 
							 использовала проверку пароля и таким образом удобно вручила ей свои логин и пароль. Жертва думает, 
							 что она подключена к серверу напрямую, когда на самом деле соединение проходит через злоумышленника. 
							 Потом он просто сидит в середине, передает данные туда и обратно между жертвой и сервером (расшифровка 
							 на одной стороне с одним ключом и снова зашифровать с другой - для ретрансляции). Конечно, он может читать 
							 все данные и незаметно изменить их. Сценарий атаки представлен на рисунке 12.
								<figure class="img">
									<img alt="ssh_mitm" src="img/ssh_mitm.png" height="75%" width="75%">
									<figcaption>Рис.12 Сценарий атаки SSH MITM</figcaption>
								</figure>
							Злоумышленник получает данные авторизации пользователя и записывает в лог весь сеанс связи, запуски команд и 
							результаты их выполнения. Если терминальная программа жертвы имеет фингерпринт ключа от удаленного сервера, 
							хранящийся в кэше, то будет выдано предупреждение о изменении ключа в момент авторизации.	
							</p>
							
							<h3 id="vulnerability">Уязвимости атаки типа «Человек посередине»</h3>
							<p>
								<h4>Уязвимость протокола ARP</h4>
								
								ARP-spoofing (ARP-poisoning) — техника сетевой атаки, которая применяется в Ethernet, но возможна и в других протоколах, использующих ARP. 
								Она основана на использовании недостатков протокола ARP и позволяет перехватить трафик между хостами, расположенными в пределах одного широковещательного домена. 
								Она относится к числу spoofing атак.
								
							<p>
								До выполнения ARP-spoofing'а в ARP-таблице узлов A и B существуют записи с IP и MAC адресами друг друга. Обмен информацией производится между узлами A и B. (зелёная стрелка)
								В ходе выполнения ARP-spoofing'а компьютер C, который выполняет атаку, отправляет ARP-ответы:
								узлу A: с IP адресом узла B и MAC адресом узла C;
								узлу B: с IP адресом узла A и MAC адресом узла C.
								Так как компьютеры поддерживают самопроизвольный ARP (gratuitous ARP), то они могут модифицировать собственные ARP-таблицы и поместить туда записи, 
								которые вместо настоящих MAC адресов узлов A и B поставят  MAC адрес узла C. (красные стрелки). 
								Наглядный пример arp-spoofing’а изображен на рисунке 13.
								<figure class="img">
									<img alt="arp_spoofing" src="img/arp_spoofing.jpg" height="55%" width="55%">
									<figcaption>Рис.13 Пример работы arp-spoofing</figcaption>
								</figure>
								После выполнения атаки, узел A хочет передать пакет узлу B, он находит в ARP-таблице запись (в которой уже записан МАС узла C) и определяет из неё MAC адрес получателя. 
								Отправляя по этому MAC адресу, пакет приходит узлу C вместо получателя. Узел C затем ретранслирует пакет тому, кому он был предназначен — т.е. узлу B. (синие стрелки).
							</p>	
							<p>
								<h4>Уязвимость протокола SSL</h4>
							
								Если нельзя «влезть» в защищённое соединение, то почему не установить два разных: одно между клиентом и злоумышленником, 
								который притворяется сервером, второе между злоумышленником и сервером.
							</p>
							<p>
								От этого алгоритм Диффи-Хелмана не защищён. Однако SSL, в отличии от Диффи Хелмана, требует аутентификацию сервера, поэтому данный подход бесполезен. 
								Во время установления соединения, клиент ждёт от сервера аутентификации, которая обязательна при использовании SSL. 
								Но вместо сервера клиент будет соединён с злоумышленником, не владеющим цифровым сертификатом, который соответствует имени сайта.
								<br>
								Существует два способа решения проблемы отсутствующего сертификата:
								<ul>
									<li>Первый способ – это создание необходимого «самоподписанного» сертификата самостоятельно. 
										Но система цифровых сертификатов требует возможности проверки состоятельности сертификата. 
										Для этого используются «удостоверяющие центры» (Certification authority, CA или УЦ). 
										Они могут подписать сертификат сайта (и не только), а также подписать сертификат других УЦ. 
										Сертификаты корневых УЦ – их мало – внесены в браузер разработчиками. 
										Браузер считает сертификат подлинным, если только он находится в конце цепочки сертификатов, 
										которая начинается с одного из УЦ (каждый следующий сертификат подписан предыдущим в цепочке).
									</li>
									<li>Второй способ – это получение у УЦ сертификата для нужного сайта и использовать этот сертификат для атаки. 
										Этот способ не подходит из-за того, что в каждом сертификате сайта указан домен, для которого он выдавался. 
										Если домен, указанный в адресной строке, не совпадет с доменом, указанным в сертификате, то браузер начнёт бить тревогу.
									</li>
								</ul>	
								<h4>SSL Strip</h4>
								
									Техника, преобразующая https ссылки в http. Таким образом заставляет цель отправлять данные в не защищенном виде. 
									Подмена происходит только в открытом трафике. Может самостоятельно проксировать соединения до оригинального https ресурса.
							</p>
							<p>
								<h4>Уязвимость протокола SSH</h4>
								
								Злоумышленник получает данные авторизации пользователя и записывает в лог весь сеанс связи, запуски команд и результаты их выполнения.
								Чтобы это осуществить, трафик жертвы перенаправляетcя на свой собственный ssh сервер, и если авторизация проходит успешно, 
								соединение проксируется до настоящего сервера.
								Если терминальная программа жертвы имеет фингерпринт ключа от удаленного сервера, 
								хранящийся в кеше, то будет выдано предупреждение о изменении ключа в момент авторизации.
							</p>
							<p>
								<h4>Уязвимость протокола WPAD</h4>
								
								WPAD — Web Proxy Auto-Discovery. Протокол автоматического получения настроек прокси в локальной сети.  Этот протокол поддерживается многими веб-браузерами и 
								рядом других приложений. Сущность его работы состоит в том, что если клиент использует DHCP для получения IP адреса, 
								то и за URL с настройкой прокси он обращается к своему DHCP серверу. Если DHCP не настроен на выдачу WPAD конфигурации, если в сети не используется DHCP, 
								то клиент попробует дать разрешение сетевому имени вида wpad.localdomain, используя DNS. Если данного имени не найдено, 
								то делается последняя попытка поиска имени 'WPAD' через NetBios. В случае, если после последней попытки имя не найдено, клиент пробует соединиться напрямую, 
								но в том случае, если кто-то сказал, что имеет имя 'WPAD', то клиент соединится по 80 порту на IP адрес ответившего хоста и попытается загрузить файл wpad.dat, 
								в котором должны быть настройки прокси.
							</p>
							<p>
								Собственный прокси-сервер позволяет злоумышленникам перехватывать и модифицировать незашифрованный HTTP-трафик. 
								Это не дает слишком многое киберпреступникам, поскольку большинство сайтов сейчас работает по HTTPS (HTTP Secure). 
								Но, поскольку PAC-файлы обеспечивают возможность задавать различные адреса прокси для определенных веб-адресов, и для этих адресов можно принудительно 
								выставить DNS lookup, хакеры создали скрипт, который позволяет получать все защищенные HTTPS URL на собственный сервер. 
								также касается информации тех пользователей, кто работает c VPN, т.к. он позволяет получить доступ и к этим данным.
							</p>
							<p>
								Сразу после начала своего существования WPAD стал дыркой в безопасности, из-за того, 
								что он позволяет легко перехватить трафик, выдавая себя за легитимный прокси сервер. 
								Эта атака не приобрела большой известности, даже несмотря на то, что эта уязвимость существует давно.
							</p>
							<p>
								<h4>Уязвимость протокола HTTP</h4>
								
								Кроме пассивного прослушивания, атаки типа «Человек посередине» могут предоставить большие возможности 
								(например, выполнение произвольного кода на стороне жертвы). При проведении атаки типа «Человек посередине», 
								злоумышленник перенаправляет трафик жертвы таким образом, что трафик идет через него, и в данном случае, может изменять пакеты. 
								Таким образом, при запросе какого-нибудь flashplayer.exe, можно подставить любой другой исполняемый файл (к примеру, bindshell код) и 
								после запуска получить возможность исполнения команд.
							</p>
							
							<p>
								DNS функционирует в формате запрос/ответ. Клиент, желающий преобразовать DNS-имя в IP-адрес, отправляет запрос на DNS-сервер, 
								а сервер отправляет запрошенную информацию в своем ответе. С точки зрения клиентов единственными двумя пакетами являются эти 
								запрос и ответ.
								Каждый DNS-запрос, направляемый по сети, содержит уникальный идентификационный номер, задачей которого является идентификация 
								запросов и ответов и их связывание. Это означает, что, если злоумышленный компьютер сможет перехватить DNS-запрос, 
								отправленный с целевого устройства, ему, лишь, придется создать ложный пакет, который будет содержать этот идентификационный 
								номер, чтобы пакет был принят целевым устройством.
							</p>
							
							<h3 id="find">Обнаружение атаки типа «Человек посередине»</h3>
							<p>
								Чтобы обнаружить атаку типа «Человек посередине», необходимо проанализировать сетевой трафик.
								<br>
								Для обнаружения атаки по SSL, нужно обратить внимание на следующие параметры:
								<ul>
									<li>IP адрес сервера;</li>
									<li>DNS-сервер;</li>
									<li>X.509 сертификат сервера
										<ul>
											<li>Подписан ли сертификат самостоятельно;</li>
											<li>Подписан ли сертификат УЦ;</li>
											<li>Был ли сертификат аннулирован;</li>
											<li>Менялся ли недавно сертификат;</li>
											<li>Получали ли другие клиенты такой же сертификат;</li>
										</ul>
									</li>	
								</ul>
							<p>
								Для обнаружения отравления ARP кэша нужен мониторинг сетевого трафика. В этом плане может помочь система обнаружения вторжений, 
								например, Snort, или с помощью утилит, специально созданных для этой задачи, например, xARP. 
								Это возможно, когда речь идет только об одном узле, но может быть довольно сложным при работе с целыми сегментами сети. 
							</p>
							<p>
								Для обнаружения атаки по SSL необходимо убедиться в том, что используется защищенное HTTPS подключение. 
								Когда выполняется атака типа «Человек посередине» по SSL, она убирает все аспекты защиты подключения, что можно увидеть в браузере. 
								Если, зайдя в свой банковский аккаунт через интернет в браузере видно, что это простое HTTP подключение, то высока вероятность того, что что-то не так. 
								Независимо от модели браузера, необходимо уметь различать защищенные подключения и незащищенные. 
							</p>
							
							
							<h3 id="defence">Способы защиты от атаки типа «Человек посередине»</h3>
							<p>
								Если рассматривать отравление ARP кэша с точки зрения защищающейся стороны, то пользователь находится в менее выгодном положении. 
								Процесс ARP происходит на заднем плане, и поэтому практически нет возможности контролировать его напрямую. 
								Не существует единого решения, но предупредительные меры можно предпринять.
								
							</p>
							<p>
								Атака ARP Cache Poisoning является действенным способом атаки только при попытке перехватить трафик между узлами в одной локальной сети. 
								Единственная причина бояться такой атаки – это если локальное устройство в сети было взломано, доверенный пользователь имеет злоумышленные намерения, 
								или кто-то смог внедрить не доверенное устройство в сеть. 
							</p>
							<p>
								<i>Жесткое программирование ARP кэша.</i>
								<br>
								Динамическую природу ARP запросов и ответов можно сделать менее динамической. 
								Это вариант, поскольку узлы на базе Windows позволяют добавлять статические записи в ARP кэш. 
								<br>
								Просматривать ARP кэш узла Windows можно, если открыть командную строку и ввести следующую команду:
								<pre><ul><li><code>arp -a.</code></li></ul></pre>
								Можно добавлять записи в этот список, используя команду:
								<pre><ul><li><code>arp –s “IP ADDRESS” “MAC ADDRESS”.</code></li></ul></pre>
								В ситуациях, когда конфигурация локальной сети не часто меняется, можно создать статические записи ARP. 
								После этого устройства всегда будут полагаться на свой локальный ARP кэш, а не на ARP запросы и ответы.
								<br>
								Однако, при выполнении команды arp –s <IP ADDRESS> <MAC ADDRESS> может быть отказано в доступе, поэтому лучше пользоваться следующей командой:
								<pre><ul><li><code>netsh interface ipv4 add neighbors “Network Name” “IP ADDRESS” “MAC ADDRESS”.</code></li></ul></pre>
								Имя сети можно посмотреть в «Центре управления сетями и общим доступом» в подменю «Изменение параметров адаптера».
							</p>
							<p>
								<i>Использование СОВ.</i>
								<br>
								Системы обнаружения вторжений, если их правильно развернуть и настроить, могут быстро обнаруживать большинство форм отравления ARP кэша и подделки DNS.
							</p>
							<p>						
								<i>Использование DNSSEC.</i>
								<br>
								DNSSEC – это более новая альтернатива протоколу DNS, которая использует записи DNS с цифровой подписью для проверки подлинности ответов на запрос. 
								DNSSEC еще не применяется широко, но принята как будущее DNS.
							</p>		
							<p>
								Также необходимо убедиться в том, что используется <i>защищенное HTTPS подключение</i>.
							</p>

							<p>
								<i>Защита от атаки на протокол WPAD</i>
								<br>
								Web Proxy Auto-Discovery Protocol (WPAD) — это протокол автоматической настройки прокси, который используется клиентами (браузером) 
								для определения места (URL) расположения конфигурационного файла с использованием технологий DHCP и/или DNS.
								<br>
								
								Самый простой способ защиты — отключить WPAD. 
								Для этого в настройках браузера необходимо зайти в настройки сети и отключить автоматическое определение параметров.
							</p>
							
							
							</p>
							<h3 id="sandbox">Песочница</a></h3>
							<p>
								Песочница в программном обеспечении ничем не отличается, от песочницы, которую построили для ребенка на детской игровой площадке. Когда ребенок играет в песочнице, 
								родители моделируют среду реальной игровой площадки (другими словами изолированную среду), но с ограничениями на то, что ребенок может делать. 
								Потому что родители не хотят, чтобы ребенок заразился или, чтобы он причинил неприятности другим детям. 
								Причина в том, что родители просто хотят, чтобы ребенок находился в безопасности.
							</p>
							<p>
								Говоря о песочнице, пользователь позволяет ПО (ребенок) играть (выполнение) в ней, но с некоторыми ограничениями над тем, что оно может сделать. 
								Пользователь может чувствовать себя в безопасности, и он знает, что его компьютер тоже находится в безопасности.
								Каждый использовал антивирусное ПО. Это тоже своего рода песочница. Она накладывает ограничения на то, что любая программа может сделать. 
								При обнаружении вредоносной активности, антивирус останавливает вредоносное ПО и сообщает пользователю, что "это приложение пытается получить доступ к 
								данным или важным системным ресурсам" и спрашивает о разрешении продолжения выполнения этой программы.
								Практическое знакомство с песочницей можно осуществить с помощью программы Sandboxie. 
								С помощью этой программы пользователь может запустить любую программу в контролируемой среде. 
								Схема работы песочницы Sandboxie представлена на рис.14.
							</p>
							<figure class="img">
									<img alt="sandboxie-scheme" src="img/sandboxie_scheme.jpg" height="60%" width="60%">
									<figcaption>Рис.14 Схема работы песочницы Sandboxie</figcaption>
							</figure>
							<p>
								Красные стрелки указывают на изменения, вытекающие из запущенной программы в ваш компьютер. Блок, помеченный значком жесткого диска (без песочницы) 
								показывает изменения программой, которая работает в обычном режиме. Блок, помеченный значком жесткий диск (с песочницей) показывает изменения по программе, 
								работающей в песочнице Sandboxie. Песочница может перехватить изменения и изолировать их в песочнице, изображенной в виде желтого прямоугольника. 
								Все изменения можно легко удалить, так как они находятся в желтом прямоугольнике.
							</p>
							<p>	
								С точки зрения программиста, песочница ограничивает API функции, которые вызывает программа. В антивирусном примере, ограничивается системный вызов ОС (API).
								Другим примером может быть онлайн арена кодирования, как TopCoder. Пользователь представляет код (программу), но она выполняется на сервере. 
								Для обеспечения безопасности сервера, TopCoder должен ограничить уровень доступа API программы. Другими словами, нужно создать песочницу и запустить программу внутри нее.
								Если у пользователя есть песочница, то он даже может запустить вирус или зараженный файл и остановить всю вредоносную активность вируса и убедиться в том, 
								что вирус или вредоносный файл пытается сделать. Это будет первым шагом антивирусного исследователя.
							</p>
							<p>
								Песочница (англ. <i>Sandbox</i>) — это ограниченная среда в системе для исполнения гостевых программ без доступа к главной ОС. Это закрытое для доступа извне 
								виртуальное пространство, в котором можно работать с программным обеспечением без изменения системных файлов. 
								Песочница (от англ. Sandbox, схожие понятия — англ. <i>honeypot</i>, англ. <i>fishbowl</i>) - в компьютерной безопасности, механизм для безопасного исполнения программ. 
								Песочницы часто используют для запуска непротестированного кода, непроверенного кода из неизвестных источников, а также для запуска и обнаружения вирусов.
							</p>
							<p>
								Песочница обычно предоставляет собой жёстко контролируемый набор ресурсов для исполнения гостевой программы — место на диске или в памяти.
								Доступ к сети, возможность сообщаться с главной ОС или считывать информацию с устройств ввода частично эмулируют, либо сильно ограничивают. 
								Песочницы представляют собой пример виртуализации.
								Программа, запущенная в песочнице "думает", что находится в нормальной среде Windows, но любой доступ к файлам перехватывается и выполняется  
								в изолированном пространстве. Таким образом, предотвращается доступ вредоносных программ к системным файлам, а также повреждение других ресурсов компьютера. 
								Основная функция песочниц — это защита файлов и ОС от некорректной или вредоносной модификации, т.е. защита Вашего компьютера.
							</p>
							<p>
								Повышенная безопасность исполнения кода в песочнице зачастую связана с большой нагрузкой на систему — именно поэтому некоторые виды песочниц используют только 
								для неотлаженного или подозрительного кода.
								<br>
									Песочницы часто встречаются в следующих видах:
									<ul>	
									<li>Апплеты, исполняющиеся в виртуальной машине или интерпретаторе, и позволяющие запускать Java-код с любых веб-сайтов без угрозы операционной системе;</li>
									<li>"Тюрьмы" (jail, chroot jail) - также позволяют вводить ограничения ресурсов для пользователей и процессов некоторых ОС;</li>
									<li>Виртуальные машины, полностью эмулирующие "стандартный" компьютер (например, VirtualBox);</li>
									<li>Системы, основанные на "возможностях" (capability-based security), также позволяют ограничивать ресурсы программ, 
									в зависимости от назначенных им "возможностей".</li>
									</ul>
									Помимо ограничения вредоносного и непроверенного кода, песочницы также используются в процессе разработки для запуска "сырого" кода, 
									который может случайно повредить систему или испортить сложную конфигурацию. Такие "тестировочные" песочницы копируют основные элементы среды, 
									для которой пишется код, и позволяют разработчикам быстро и безболезненно экспериментировать с неотлаженным кодом.

							</p>

							<pre><font color = "blue">Термин "Песочница" в данной работе используется с точки зрения <strong>анализа поведения</strong> (англ. <i>behavior based analysis</i>) пользователей. Так как одной из целей использования песочницы является анализ поведения вредоносного ПО.</font></pre>
							<!--
							<h3 id="materials">Дополнительные материалы</h3>
							<ol>
								<li><a href="http://???.ru">???</a></li>
								<li><a href="http://???.com/">???</a></li>
							</ol>
							-->
						</div>
					</div>
				</div>
			</div>

			<script src="js/lib/jquery-1.10.2.min.js"></script>
			<script>
				$(function() {
					$('#demo1-slot').html($('#demo1-field').val());
					$('#demo2-slot').html($('#demo2-field').val());
					$('#demo1-field').keyup(function() {
						$('#demo1-slot').html($(this).val());
					});
					$('#demo2-field').keyup(function() {
						$('#demo2-slot').html($(this).val());
					});
				});
			</script>
		</body>
	</html>
